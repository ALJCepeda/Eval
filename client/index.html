<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>3val</title>

	<script src="/jquery.js" type="text/javascript"></script>
	<script src="/knockout.js" type="text/javascript"></script>
	<script src="/ace-builds/src-min-noconflict/ace.js" type="text/javascript"></script>
	<script src="/underscore.js" type="text/javascript"></script>
	<script src="/backbone.js" type="text/javascript"></script>
    <script src="/materialize/js/materialize.js" type="text/javascript"></script>

	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link type="text/css" rel="stylesheet" href="materialize/css/materialize.min.css"  media="screen,projection"/>
	<link rel="stylesheet" href="assets/css/flex.css">
	<style type="text/css" media="screen">
		body {
			background-color: black;
		}
		.submit {
			position:absolute;
			bottom:20px;
			right:20px;
		}

		.page {
			margin: 0;
			position:absolute;
			top:65px;
			bottom: 0;
			left: 0;
			right: 0;
			z-index: -1;
		}

		.modal-content > h1, h2, h3, h4, h5, h6 {
			padding-bottom: 10px;
		}

		.modal-large {
			min-height: 50%;
		}
	</style>
</head>

<body>
	<nav>
	    <div class="nav-wrapper">
	      	<a href="#" class="brand-logo" style="padding-left:10px;">3val</a>
	      	<ul id="nav-mobile" class="right hide-on-med-and-down">
				<li>
					<a class="waves-effect waves-light" href="#create">
						<i class="material-icons dp48">add</i>
					</a>
				</li>

				<li>
					<a class="waves-effect waves-light" href="#settings">
						<i class="material-icons dp48">settings</i>
					</a>
				</li>

				<li>
					<a class="waves-effect waves-light" href="#submit">
						<i class="material-icons dp48">done</i>
					</a>
				</li>
	      	</ul>
		</div>
	</nav>

	<div class="container">
		<pre class="page" id="editor"></pre>

		<div id="modal-newProject" class="modal">
			<div class="modal-content" style="min-height: 300px;">
				<h4>New Project</h4>

				<div class="row">
					<form class="col s12">
						<div class="row">
							<div class="input-field col s6">
							    <select id='selectPlatform' data-bind="options: platforms,
								 					optionsText: 'text',
													optionsValue: 'value',
													value: selectedPlatform,
													optionsAfterRender: setPlatformDisable">
								</select>

							    <label>Platform select</label>
							</div>

							<div class="input-field col s6">
								<select id='selectVersion' data-bind="options: versions,
								 					optionsText: 'text',
													optionsValue: 'value',
													value: selectedVersion,
													optionsAfterRender: setVersionDisable">
							    </select>

							    <label>Version select</label>
							</div>
						</div>
					</form>
				</div>
			</div>

			<div class="modal-footer">
				<a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Start</a>
			</div>
		</div>
	</div>

	<script type="text/javascript">
		var editor = ace.edit("editor");
		editor.$blockScrolling = Infinity;
		editor.session.setMode("ace/mode/php");
		editor.setTheme("ace/theme/monokai");

		var info = {
			php: { text:'PHP', tags: [ '5.4', '5.5', '5.6' ] },
			nodejs: { text:'NodeJS', tags: [ '0.12.4' ] },
			haskell: { text:'Haskell', tags: [ 'latest' ] },
			pascal: { text:'Pascal', tags: [ '2.6.4' ]}
		};

		var model = function() {
			var self = this;
			var firstPlatform = { value: '', text: 'Choose your platform', disable:true };
			var firstVersion = { value: '', text: 'Choose your version', disable:true };

			this.selectedPlatform = ko.observable('');
			this.selectedVersion = ko.observable('');

			this.platforms = ko.observableArray([ firstPlatform ]);
			this.versions = ko.computed(function() {
				var platform = this.selectedPlatform();
				var tags = [ firstVersion ];

				if(platform === "") { return tags; }

				[].push.apply(tags, info[platform].tags.map(function(tag) {
					return { value: tag, text: tag, disable: false };
				}));

				this.selectedVersion('');
				setTimeout(function() {
					$('#selectVersion').material_select();
				});

				return tags;
			}.bind(this));

			this.setPlatformDisable = function(option, platform) {
            	ko.applyBindingsToNode(option, {disable: platform.disable}, platform);
        	};
			this.setVersionDisable = function(option, version) {
				ko.applyBindingsToNode(option, {disable: version.disable}, version);
			};

			for(var key in info) {
				var platform = { value:key, text:info[key].text, disable:false };
				this.platforms.push(platform);
			}
		}
		ko.applyBindings(new model());

		$('#modal-newProject').openModal();
		$('select').material_select();
	</script>
</body>

</html>
